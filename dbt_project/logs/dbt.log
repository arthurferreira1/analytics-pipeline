

============================== 2023-05-04 20:39:58.401618 | a82c5dc7-1404-4737-98c1-0255ce131f31 ==============================
[0m20:39:58.401635 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:39:58.403024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m20:39:58.404202 [debug] [MainThread]: Tracking: tracking
[0m20:39:58.407250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c06980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c06bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c060e0>]}
[0m20:39:58.413662 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9xt7t9iy'
[0m20:39:58.415837 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:39:59.115047 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:39:59.117751 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:39:59.431935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:39:59.486605 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:40:10.008491 [info ] [MainThread]:   Installed from version 1.0.0
[0m20:40:10.010991 [info ] [MainThread]:   Updated version available: 1.1.0
[0m20:40:10.013470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a82c5dc7-1404-4737-98c1-0255ce131f31', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c06170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c07850>]}
[0m20:40:10.015607 [info ] [MainThread]: 
[0m20:40:10.017584 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:40:10.020420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27bd1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c05360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27c064d0>]}
[0m20:40:10.022890 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 20:44:07.945819 | 7d06c6f9-bfc8-4400-8779-f2cbd6ff3be0 ==============================
[0m20:44:07.945838 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:44:07.947422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m20:44:07.948641 [debug] [MainThread]: Tracking: tracking
[0m20:44:07.962850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1884195a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa188419690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa188419630>]}
[0m20:44:07.968097 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kpnec5rm'
[0m20:44:07.969805 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:44:08.478452 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:44:08.481945 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:44:08.777256 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:44:08.824551 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:44:18.046912 [info ] [MainThread]:   Installed from version 1.0.0
[0m20:44:18.048547 [info ] [MainThread]:   Updated version available: 1.1.0
[0m20:44:18.050258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d06c6f9-bfc8-4400-8779-f2cbd6ff3be0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa188419990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1884197b0>]}
[0m20:44:18.051777 [info ] [MainThread]: 
[0m20:44:18.053193 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:44:18.056117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa188385330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1883c0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa188419090>]}
[0m20:44:18.057458 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 20:44:21.995487 | 0710c298-9ca9-4d71-b763-29e983d7f8e1 ==============================
[0m20:44:21.995516 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:44:21.998132 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m20:44:22.000544 [debug] [MainThread]: Tracking: tracking
[0m20:44:22.005446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccae5cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccae5cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccae5cf70>]}
[0m20:44:22.126872 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m20:44:22.128741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0710c298-9ca9-4d71-b763-29e983d7f8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccae5fa00>]}
[0m20:44:24.529827 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:44:24.557033 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m20:44:24.560665 [debug] [MainThread]: Parsing macros/relations.sql
[0m20:44:24.563714 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:44:24.567694 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:44:24.576405 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:44:24.579245 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:44:24.581663 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:44:24.585084 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:44:24.588069 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:44:24.591114 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m20:44:24.593804 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m20:44:24.597220 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:44:24.600104 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:44:24.602669 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:44:24.605093 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:44:24.606977 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:44:24.616744 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:44:24.624242 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:44:24.626778 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:44:24.630341 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:44:24.634561 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:44:24.638720 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:44:24.642635 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:44:24.651845 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:44:24.658254 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:44:24.673115 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:44:24.688934 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m20:44:24.694336 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:44:24.698645 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:44:24.708798 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:44:24.711586 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m20:44:24.715752 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:44:24.721092 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m20:44:24.724814 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:44:24.727805 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:44:24.730202 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:44:24.733224 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:44:24.736548 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:44:24.739313 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:44:24.742241 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:44:24.744963 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m20:44:24.748104 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:44:24.749986 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:44:24.751803 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:44:24.753782 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:44:24.756061 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:44:24.758017 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:44:24.761307 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:44:24.764617 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:44:24.766560 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:44:24.768863 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:44:24.771030 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:44:24.774486 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:44:24.781924 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:44:24.784906 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:44:24.790063 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:44:24.797216 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:44:24.813520 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:44:24.819693 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:44:24.823067 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:44:24.826072 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:44:24.831440 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:44:24.834042 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m20:44:24.841329 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:44:24.856239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:44:24.866920 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:44:24.876091 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:44:24.892617 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:44:24.899075 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:44:24.903459 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:44:24.919034 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:44:24.921860 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:44:24.934395 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:44:24.946491 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:44:24.949751 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:44:24.952368 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:44:24.957341 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m20:44:24.964126 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:44:24.967987 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m20:44:24.971173 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m20:44:24.974679 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m20:44:24.977333 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m20:44:24.981912 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m20:44:24.986793 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m20:44:24.989807 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m20:44:24.994675 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m20:44:25.004018 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m20:44:25.007643 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m20:44:25.010842 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m20:44:25.013345 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m20:44:25.017186 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m20:44:25.021574 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m20:44:25.024691 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m20:44:25.029485 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m20:44:25.033069 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m20:44:25.034829 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m20:44:25.036580 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m20:44:25.038831 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m20:44:25.040991 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m20:44:25.043605 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m20:44:25.045692 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m20:44:25.050641 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m20:44:25.054946 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m20:44:25.059396 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m20:44:25.062715 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m20:44:25.068758 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m20:44:25.072766 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m20:44:25.075917 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m20:44:25.080947 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m20:44:25.085268 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m20:44:25.088889 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m20:44:25.096055 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m20:44:25.098499 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m20:44:25.100605 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m20:44:25.102518 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m20:44:25.108483 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m20:44:25.110989 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m20:44:25.113484 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m20:44:25.118005 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m20:44:25.121079 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m20:44:25.123179 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m20:44:25.129764 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m20:44:25.132750 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m20:44:25.146717 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m20:44:25.153405 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m20:44:25.159196 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m20:44:25.162833 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m20:44:25.165847 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m20:44:25.554466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0710c298-9ca9-4d71-b763-29e983d7f8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc9469c60>]}
[0m20:44:25.581612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0710c298-9ca9-4d71-b763-29e983d7f8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccae5d9c0>]}
[0m20:44:25.583445 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:44:25.585009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0710c298-9ca9-4d71-b763-29e983d7f8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccae16f80>]}
[0m20:44:25.587579 [info ] [MainThread]: 
[0m20:44:25.589341 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:44:25.617499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc946a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc94681c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc946b760>]}
[0m20:44:25.619037 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 20:59:26.751970 | 37c289a1-bdc7-4d46-ab33-5694b2a63d37 ==============================
[0m20:59:26.751990 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:59:26.753872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m20:59:26.755136 [debug] [MainThread]: Tracking: tracking
[0m20:59:26.759391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be181600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be1816f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be181690>]}
[0m20:59:26.765741 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7p0inix3'
[0m20:59:26.768253 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:59:27.484866 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:59:27.487663 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:59:27.775093 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:59:27.827350 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:59:37.631481 [info ] [MainThread]:   Installed from version 1.0.0
[0m20:59:37.632990 [info ] [MainThread]:   Updated version available: 1.1.0
[0m20:59:37.634705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '37c289a1-bdc7-4d46-ab33-5694b2a63d37', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be1819f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be181810>]}
[0m20:59:37.636336 [info ] [MainThread]: 
[0m20:59:37.637898 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:59:37.639726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be2e5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be325d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0be181120>]}
[0m20:59:37.641405 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 20:59:41.116660 | e6069581-a6f7-418e-99a3-e25501b4f76f ==============================
[0m20:59:41.116677 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:59:41.118248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m20:59:41.119835 [debug] [MainThread]: Tracking: tracking
[0m20:59:41.122804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc259b722c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc259b71f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc259b71fc0>]}
[0m20:59:43.437427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:59:43.439526 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://seeds/_seeds.yml
[0m20:59:43.441328 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://seeds/customer_base.csv
[0m20:59:43.516638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6069581-a6f7-418e-99a3-e25501b4f76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc258283a60>]}
[0m20:59:43.546965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6069581-a6f7-418e-99a3-e25501b4f76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2581f6770>]}
[0m20:59:43.548721 [info ] [MainThread]: Found 0 models, 2 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m20:59:43.550038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6069581-a6f7-418e-99a3-e25501b4f76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc25b94b4f0>]}
[0m20:59:43.552648 [info ] [MainThread]: 
[0m20:59:43.554571 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:59:43.557094 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:59:43.569890 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:59:43.571252 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:59:43.572381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:43.593762 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m20:59:43.596918 [debug] [ThreadPool]: On list_postgres: Close
[0m20:59:43.600615 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:59:43.607239 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:59:43.608822 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:59:43.609854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:43.613634 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:59:43.615713 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:59:43.617667 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:59:43.622484 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.0 seconds
[0m20:59:43.625637 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:59:43.627585 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:59:43.635363 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:43.636741 [debug] [MainThread]: On master: BEGIN
[0m20:59:43.637799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:43.641368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:59:43.642605 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:43.643758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:59:43.659661 [debug] [MainThread]: SQL status: SELECT 43 in 0.01 seconds
[0m20:59:43.663323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6069581-a6f7-418e-99a3-e25501b4f76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2580c97b0>]}
[0m20:59:43.665515 [debug] [MainThread]: On master: ROLLBACK
[0m20:59:43.667505 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:43.669085 [debug] [MainThread]: On master: BEGIN
[0m20:59:43.671730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:59:43.673653 [debug] [MainThread]: On master: COMMIT
[0m20:59:43.675330 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:43.677240 [debug] [MainThread]: On master: COMMIT
[0m20:59:43.679112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:59:43.681220 [debug] [MainThread]: On master: Close
[0m20:59:43.683634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:59:43.686303 [info ] [MainThread]: 
[0m20:59:43.704795 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m20:59:43.706218 [info ] [Thread-1 (]: 1 of 3 START seed file public.customer_base .................................... [RUN]
[0m20:59:43.707796 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m20:59:43.708941 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m20:59:43.710023 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:43.711348 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m20:59:43.798198 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m20:59:43.800473 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m20:59:43.802980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:43.807624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:43.809079 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m20:59:43.810319 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */

    create table "postgres"."public"."customer_base" ("customer_id" integer,"store_id" integer,"first_name" text,"last_name" text,"email" text,"address_id" integer,"activebool" text,"create_date" date,"last_update" timestamp without time zone,"active" integer)
  
[0m20:59:43.835251 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.02 seconds
[0m20:59:45.136096 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m20:59:45.137469 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m20:59:45.165591 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.03 seconds
[0m20:59:45.174846 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m20:59:45.220615 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m20:59:45.222331 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m20:59:45.223601 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m20:59:45.226589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:59:45.228754 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:45.230928 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m20:59:45.233690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6069581-a6f7-418e-99a3-e25501b4f76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2580c9ba0>]}
[0m20:59:45.236108 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.customer_base ................................ [[32mINSERT 599[0m in 1.53s]
[0m20:59:45.238031 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m20:59:45.240039 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m20:59:45.241350 [info ] [Thread-1 (]: 2 of 3 START test not_null_customer_base_customer_id ........................... [RUN]
[0m20:59:45.243288 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m20:59:45.244887 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m20:59:45.247004 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m20:59:45.268229 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m20:59:45.310965 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:45.312990 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m20:59:45.329592 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m20:59:45.363441 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m20:59:45.365106 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m20:59:45.366916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:45.370625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:45.372188 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m20:59:45.373509 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m20:59:45.376968 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:59:45.380768 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:45.383063 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m20:59:45.384712 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m20:59:45.386363 [info ] [Thread-1 (]: 2 of 3 PASS not_null_customer_base_customer_id ................................. [[32mPASS[0m in 0.14s]
[0m20:59:45.387762 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m20:59:45.388988 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m20:59:45.390193 [info ] [Thread-1 (]: 3 of 3 START test not_null_customer_base_store_id .............................. [RUN]
[0m20:59:45.391960 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m20:59:45.393824 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m20:59:45.395957 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m20:59:45.402171 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m20:59:45.452532 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:45.454749 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m20:59:45.460136 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m20:59:45.479433 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m20:59:45.481050 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m20:59:45.482806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:45.487430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:45.489173 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m20:59:45.491092 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m20:59:45.494032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:59:45.497079 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:45.498906 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m20:59:45.501140 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m20:59:45.503645 [info ] [Thread-1 (]: 3 of 3 PASS not_null_customer_base_store_id .................................... [[32mPASS[0m in 0.11s]
[0m20:59:45.506089 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m20:59:45.509179 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:59:45.510393 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:45.511482 [debug] [MainThread]: On master: BEGIN
[0m20:59:45.512667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:45.516940 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:59:45.518653 [debug] [MainThread]: On master: COMMIT
[0m20:59:45.520838 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:45.522046 [debug] [MainThread]: On master: COMMIT
[0m20:59:45.523709 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:59:45.524889 [debug] [MainThread]: On master: Close
[0m20:59:45.537746 [info ] [MainThread]: 
[0m20:59:45.540068 [info ] [MainThread]: Finished running 1 seed, 2 tests in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m20:59:45.542135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:45.543464 [debug] [MainThread]: Connection 'test.test_dbt_project.not_null_customer_base_store_id.e159464168' was properly closed.
[0m20:59:45.569750 [info ] [MainThread]: 
[0m20:59:45.572384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:45.574369 [info ] [MainThread]: 
[0m20:59:45.575891 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:59:45.577467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2582015a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc258283100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc258283e50>]}
[0m20:59:45.578942 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:07:45.505250 | 06e186f2-49f0-41ec-b9b8-ef2334785dd3 ==============================
[0m21:07:45.505268 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:07:45.506591 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m21:07:45.507715 [debug] [MainThread]: Tracking: tracking
[0m21:07:45.511124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb191e5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb191e5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb191e56c0>]}
[0m21:07:45.517358 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_jemrlzy'
[0m21:07:45.519030 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:07:46.263965 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:07:46.266896 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:07:46.563970 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:07:46.617617 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:07:57.406875 [info ] [MainThread]:   Installed from version 1.0.0
[0m21:07:57.408453 [info ] [MainThread]:   Updated version available: 1.1.0
[0m21:07:57.410432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '06e186f2-49f0-41ec-b9b8-ef2334785dd3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb191e5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb191e5840>]}
[0m21:07:57.412192 [info ] [MainThread]: 
[0m21:07:57.413722 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:07:57.416497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb193493c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb19389120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb191e5210>]}
[0m21:07:57.418141 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:08:01.541674 | e55bb8e5-1910-4320-8069-da65780969a2 ==============================
[0m21:08:01.541691 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:08:01.544161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:08:01.545730 [debug] [MainThread]: Tracking: tracking
[0m21:08:01.550534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b90ee260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b90edf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b90edf60>]}
[0m21:08:02.253583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b90effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b777dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b777df90>]}
[0m21:08:02.255462 [debug] [MainThread]: Flushing usage events
[0m21:08:02.947411 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at snapshots/_snapshots.yml is invalid because the yml property file snapshots/_snapshots.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-05-04 21:11:15.236621 | b6b81d86-b18e-43b4-a60c-b308aee9fe22 ==============================
[0m21:11:15.236653 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:11:15.238327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m21:11:15.239697 [debug] [MainThread]: Tracking: tracking
[0m21:11:15.244523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae9f5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae9f5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae9f56f0>]}
[0m21:11:15.250076 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oseytw99'
[0m21:11:15.251562 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:11:15.925111 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:11:15.928476 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:11:16.845612 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:11:16.902862 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:11:27.857842 [info ] [MainThread]:   Installed from version 1.0.0
[0m21:11:27.859128 [info ] [MainThread]:   Updated version available: 1.1.0
[0m21:11:27.860483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b6b81d86-b18e-43b4-a60c-b308aee9fe22', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae9f5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae9f5870>]}
[0m21:11:27.861807 [info ] [MainThread]: 
[0m21:11:27.863139 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:11:27.864886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdaeb593f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdaeb99150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae9f5150>]}
[0m21:11:27.866236 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:11:30.738392 | b1a93579-1bbc-47e2-9833-de364496ad2e ==============================
[0m21:11:30.738415 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:11:30.740182 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:11:30.741666 [debug] [MainThread]: Tracking: tracking
[0m21:11:30.744853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbc5e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbc5e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbc5e2f0>]}
[0m21:11:33.405702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m21:11:33.408185 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/marts/cumulative_revenue.sql
[0m21:11:33.410631 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/intermediate/int_revenue_by_date.sql
[0m21:11:33.412222 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/marts/_mart_models.yml
[0m21:11:33.413935 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/staging/_staging_models.yml
[0m21:11:33.415918 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/staging/stg_payments.sql
[0m21:11:33.417423 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/intermediate/int_customers_per_store.sql
[0m21:11:33.419213 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/staging/_staging_sources.yml
[0m21:11:33.421230 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/intermediate/_intermediate_models.yml
[0m21:11:33.443465 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m21:11:33.460038 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m21:11:33.465912 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m21:11:33.471318 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m21:11:33.520524 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_payment' in the 'models' section of file 'models/staging/_staging_models.yml'
[0m21:11:33.611714 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.unique_stg_payment_payment_id.7398e70184' (models/staging/_staging_models.yml) depends on a node named 'stg_payment' which was not found
[0m21:11:33.614326 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72' (models/staging/_staging_models.yml) depends on a node named 'stg_payment' which was not found
[0m21:11:33.617021 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce' (models/staging/_staging_models.yml) depends on a node named 'stg_payment' which was not found
[0m21:11:33.663961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c91fc0d0>]}
[0m21:11:33.702743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca2efee0>]}
[0m21:11:33.705522 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:11:33.707810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbd527a0>]}
[0m21:11:33.711728 [info ] [MainThread]: 
[0m21:11:33.716217 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:11:33.732000 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:11:33.753588 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:11:33.755530 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:11:33.757153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:33.767479 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m21:11:33.770377 [debug] [ThreadPool]: On list_postgres: Close
[0m21:11:33.774370 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:11:33.785379 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:11:33.787277 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:11:33.788772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:33.793587 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:33.795579 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:11:33.797150 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:11:33.801547 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.0 seconds
[0m21:11:33.805737 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:11:33.807729 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:11:33.816592 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:33.818462 [debug] [MainThread]: On master: BEGIN
[0m21:11:33.820923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:33.825683 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:33.827605 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:33.829257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:11:33.843168 [debug] [MainThread]: SQL status: SELECT 43 in 0.01 seconds
[0m21:11:33.848192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c91f6320>]}
[0m21:11:33.850743 [debug] [MainThread]: On master: ROLLBACK
[0m21:11:33.853604 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:33.855717 [debug] [MainThread]: On master: BEGIN
[0m21:11:33.857897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:33.859418 [debug] [MainThread]: On master: COMMIT
[0m21:11:33.860876 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:33.862316 [debug] [MainThread]: On master: COMMIT
[0m21:11:33.864160 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:11:33.866011 [debug] [MainThread]: On master: Close
[0m21:11:33.869227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:33.871004 [info ] [MainThread]: 
[0m21:11:33.878253 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m21:11:33.880382 [info ] [Thread-1 (]: 1 of 10 START sql view model public.int_customers_per_store .................... [RUN]
[0m21:11:33.882995 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:11:33.884830 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m21:11:33.886622 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m21:11:33.892369 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m21:11:33.934792 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:33.936838 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m21:11:33.998748 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m21:11:34.042580 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:11:34.044347 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m21:11:34.046016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:34.051494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:11:34.053277 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:11:34.054859 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    version: 2

models:
  - name: int_revenue_by_date
  - name: int_customers_per_store
    columns:
      - name: store_id
        tests:
          - unique
          - not_null
      - name: total_customers
        tests:
          - not_null
  );
[0m21:11:34.068569 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 4:     version: 2
            ^

[0m21:11:34.070804 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: ROLLBACK
[0m21:11:34.072792 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:34.074236 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m21:11:34.076052 [debug] [Thread-1 (]: Database Error in model int_customers_per_store (models/intermediate/int_customers_per_store.sql)
  syntax error at or near "version"
  LINE 4:     version: 2
              ^
  compiled Code at target/run/test_dbt_project/models/intermediate/int_customers_per_store.sql
[0m21:11:34.077532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9249fc0>]}
[0m21:11:34.079441 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.int_customers_per_store ........... [[31mERROR[0m in 0.20s]
[0m21:11:34.081730 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m21:11:34.083582 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payments
[0m21:11:34.085806 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_payments ............................... [RUN]
[0m21:11:34.089449 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payments"
[0m21:11:34.091377 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payments
[0m21:11:34.092724 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payments
[0m21:11:34.098961 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payments"
[0m21:11:34.133299 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:34.135944 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payments
[0m21:11:34.143492 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payments"
[0m21:11:34.179337 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:11:34.181024 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: BEGIN
[0m21:11:34.182692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:34.187800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:11:34.189590 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:11:34.191291 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m21:11:34.213155 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m21:11:34.225903 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:11:34.228544 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:11:34.233578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:11:34.261899 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: COMMIT
[0m21:11:34.263711 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:11:34.265302 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: COMMIT
[0m21:11:34.269144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:11:34.276552 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:11:34.278998 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m21:11:34.282308 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:11:34.285855 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:34.287956 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: Close
[0m21:11:34.290624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9249ed0>]}
[0m21:11:34.292261 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_payments .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m21:11:34.293958 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payments
[0m21:11:34.295650 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m21:11:34.297410 [info ] [Thread-1 (]: 3 of 10 START seed file public.customer_base ................................... [RUN]
[0m21:11:34.299738 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m21:11:34.302564 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m21:11:34.304479 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:34.306172 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m21:11:34.424632 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:11:34.426295 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m21:11:34.427767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:34.432889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:11:34.434788 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:11:34.436558 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m21:11:34.454366 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m21:11:36.018831 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:11:36.020819 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:11:36.036699 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.01 seconds
[0m21:11:36.044981 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m21:11:36.067210 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:11:36.069430 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:11:36.071185 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:11:36.087477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m21:11:36.089614 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.091636 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m21:11:36.093582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca333550>]}
[0m21:11:36.095030 [info ] [Thread-1 (]: 3 of 10 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.79s]
[0m21:11:36.096701 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m21:11:36.098076 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:11:36.099758 [info ] [Thread-1 (]: 4 of 10 SKIP test not_null_int_customers_per_store_store_id .................... [[33mSKIP[0m]
[0m21:11:36.101697 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:11:36.105313 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:11:36.107002 [info ] [Thread-1 (]: 5 of 10 SKIP test not_null_int_customers_per_store_total_customers ............. [[33mSKIP[0m]
[0m21:11:36.109310 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:11:36.110777 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:11:36.112327 [info ] [Thread-1 (]: 6 of 10 SKIP test unique_int_customers_per_store_store_id ...................... [[33mSKIP[0m]
[0m21:11:36.116385 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:11:36.118768 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:11:36.120624 [info ] [Thread-1 (]: 7 of 10 START test not_null_customer_base_customer_id .......................... [RUN]
[0m21:11:36.124234 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:11:36.126367 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:11:36.128051 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:11:36.151748 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:11:36.174688 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.176550 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:11:36.197060 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:11:36.216418 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:11:36.217931 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m21:11:36.219259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:36.223947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:11:36.225636 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:11:36.227271 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m21:11:36.230289 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:11:36.235456 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.237871 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m21:11:36.240293 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m21:11:36.242582 [info ] [Thread-1 (]: 7 of 10 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.12s]
[0m21:11:36.245017 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:11:36.247063 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:11:36.248716 [info ] [Thread-1 (]: 8 of 10 START test not_null_customer_base_store_id ............................. [RUN]
[0m21:11:36.251048 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:11:36.252945 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:11:36.255748 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:11:36.266071 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:11:36.288062 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.289707 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:11:36.294381 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:11:36.317627 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:11:36.318918 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m21:11:36.320450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:36.324655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:11:36.326904 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:11:36.329239 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m21:11:36.332783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:11:36.335524 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.336707 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m21:11:36.338009 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m21:11:36.339662 [info ] [Thread-1 (]: 8 of 10 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.09s]
[0m21:11:36.341083 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:11:36.343210 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m21:11:36.344472 [info ] [Thread-1 (]: 9 of 10 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m21:11:36.346618 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.348260 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m21:11:36.350227 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m21:11:36.355782 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.373766 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.375615 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m21:11:36.384042 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.405639 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.407109 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m21:11:36.408590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:36.412802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:11:36.414872 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.416259 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m21:11:36.420578 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:11:36.424503 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.425809 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m21:11:36.427445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:11:36.432068 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m21:11:36.433580 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.434763 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m21:11:36.436884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:11:36.440358 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:11:36.441848 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m21:11:36.444009 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:11:36.447191 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.449071 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m21:11:36.451902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9278430>]}
[0m21:11:36.455746 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.11s]
[0m21:11:36.458850 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m21:11:36.461318 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m21:11:36.463253 [info ] [Thread-1 (]: 10 of 10 START sql table model public.cumulative_revenue ....................... [RUN]
[0m21:11:36.465483 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:11:36.467658 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m21:11:36.468955 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m21:11:36.473507 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m21:11:36.506033 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.507431 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m21:11:36.535195 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m21:11:36.568459 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:11:36.569967 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m21:11:36.571459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:36.577175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:11:36.578835 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:11:36.580395 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m21:11:36.583492 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "payment_date" does not exist
LINE 11:     payment_date,
             ^

[0m21:11:36.585795 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: ROLLBACK
[0m21:11:36.587753 [debug] [Thread-1 (]: finished collecting timing info
[0m21:11:36.589467 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m21:11:36.591406 [debug] [Thread-1 (]: Database Error in model cumulative_revenue (models/marts/cumulative_revenue.sql)
  column "payment_date" does not exist
  LINE 11:     payment_date,
               ^
  compiled Code at target/run/test_dbt_project/models/marts/cumulative_revenue.sql
[0m21:11:36.593567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a93579-1bbc-47e2-9833-de364496ad2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c90e9ba0>]}
[0m21:11:36.595657 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model public.cumulative_revenue .............. [[31mERROR[0m in 0.13s]
[0m21:11:36.597327 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m21:11:36.600435 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:11:36.603008 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:36.604628 [debug] [MainThread]: On master: BEGIN
[0m21:11:36.605842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:11:36.609565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:36.610834 [debug] [MainThread]: On master: COMMIT
[0m21:11:36.612006 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:36.613291 [debug] [MainThread]: On master: COMMIT
[0m21:11:36.614892 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:11:36.616068 [debug] [MainThread]: On master: Close
[0m21:11:36.618333 [info ] [MainThread]: 
[0m21:11:36.620691 [info ] [MainThread]: Finished running 3 view models, 1 seed, 5 tests, 1 table model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m21:11:36.622489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:36.623827 [debug] [MainThread]: Connection 'model.test_dbt_project.cumulative_revenue' was properly closed.
[0m21:11:36.652828 [info ] [MainThread]: 
[0m21:11:36.655487 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:11:36.657872 [info ] [MainThread]: 
[0m21:11:36.659609 [error] [MainThread]: [33mDatabase Error in model int_customers_per_store (models/intermediate/int_customers_per_store.sql)[0m
[0m21:11:36.661064 [error] [MainThread]:   syntax error at or near "version"
[0m21:11:36.662931 [error] [MainThread]:   LINE 4:     version: 2
[0m21:11:36.664559 [error] [MainThread]:               ^
[0m21:11:36.666064 [error] [MainThread]:   compiled Code at target/run/test_dbt_project/models/intermediate/int_customers_per_store.sql
[0m21:11:36.667429 [info ] [MainThread]: 
[0m21:11:36.668733 [error] [MainThread]: [33mDatabase Error in model cumulative_revenue (models/marts/cumulative_revenue.sql)[0m
[0m21:11:36.670264 [error] [MainThread]:   column "payment_date" does not exist
[0m21:11:36.672083 [error] [MainThread]:   LINE 11:     payment_date,
[0m21:11:36.675136 [error] [MainThread]:                ^
[0m21:11:36.677157 [error] [MainThread]:   compiled Code at target/run/test_dbt_project/models/marts/cumulative_revenue.sql
[0m21:11:36.678839 [info ] [MainThread]: 
[0m21:11:36.680360 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 TOTAL=10
[0m21:11:36.682190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca333c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c90ea2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c90f8f70>]}
[0m21:11:36.683711 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:14:51.645117 | 662ac627-741b-4315-8063-d54ae0b066f6 ==============================
[0m21:14:51.645135 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:14:51.647634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m21:14:51.649740 [debug] [MainThread]: Tracking: tracking
[0m21:14:51.652762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b0955d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b0956c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b095660>]}
[0m21:14:51.658448 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dh5og_yf'
[0m21:14:51.660656 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:14:52.445467 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:14:52.449153 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:14:52.755958 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:14:52.800987 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:15:05.363171 [info ] [MainThread]:   Installed from version 1.0.0
[0m21:15:05.364752 [info ] [MainThread]:   Updated version available: 1.1.0
[0m21:15:05.366390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '662ac627-741b-4315-8063-d54ae0b066f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b0959c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b0957e0>]}
[0m21:15:05.367803 [info ] [MainThread]: 
[0m21:15:05.369065 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:15:05.370623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b1f9360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b239d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37b0951b0>]}
[0m21:15:05.371880 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:15:08.808002 | fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f ==============================
[0m21:15:08.808017 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:15:08.809365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:15:08.810726 [debug] [MainThread]: Tracking: tracking
[0m21:15:08.813605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd84a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd849ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd84a2c0>]}
[0m21:15:11.406548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:15:11.408681 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_customers_per_store.sql
[0m21:15:11.410063 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_revenue_by_date.sql
[0m21:15:11.426615 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m21:15:11.445885 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m21:15:11.514121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc70c040>]}
[0m21:15:11.546775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd7c9840>]}
[0m21:15:11.548653 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:15:11.550403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540165abc0>]}
[0m21:15:11.553686 [info ] [MainThread]: 
[0m21:15:11.556975 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:15:11.561217 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:15:11.583396 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:15:11.585957 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:15:11.587763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:11.592628 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:15:11.594661 [debug] [ThreadPool]: On list_postgres: Close
[0m21:15:11.598062 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:15:11.605954 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:15:11.607054 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:15:11.608092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:11.611429 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:11.612929 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:15:11.614327 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:15:11.618804 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.0 seconds
[0m21:15:11.622524 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:15:11.624361 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:15:11.630230 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:11.632252 [debug] [MainThread]: On master: BEGIN
[0m21:15:11.634716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:11.638808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:11.640032 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:11.641216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:11.649981 [debug] [MainThread]: SQL status: SELECT 45 in 0.01 seconds
[0m21:15:11.655946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc70c550>]}
[0m21:15:11.657681 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:11.659661 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:11.661383 [debug] [MainThread]: On master: BEGIN
[0m21:15:11.663309 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:11.664752 [debug] [MainThread]: On master: COMMIT
[0m21:15:11.666974 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:11.668260 [debug] [MainThread]: On master: COMMIT
[0m21:15:11.669646 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:11.670680 [debug] [MainThread]: On master: Close
[0m21:15:11.672440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:15:11.673601 [info ] [MainThread]: 
[0m21:15:11.677717 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m21:15:11.679084 [info ] [Thread-1 (]: 1 of 10 START sql view model public.int_customers_per_store .................... [RUN]
[0m21:15:11.680948 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:15:11.682190 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m21:15:11.683580 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m21:15:11.687801 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m21:15:11.706689 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:11.708106 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m21:15:11.746406 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m21:15:11.769943 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:15:11.771735 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m21:15:11.773161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:11.776970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:11.778137 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:15:11.779401 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    models:
  - name: int_revenue_by_date
  - name: int_customers_per_store
    columns:
      - name: store_id
        tests:
          - unique
          - not_null
      - name: total_customers
        tests:
          - not_null
  );
[0m21:15:11.781239 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "models"
LINE 4:     models:
            ^

[0m21:15:11.783780 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: ROLLBACK
[0m21:15:11.785804 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:11.787128 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m21:15:11.788581 [debug] [Thread-1 (]: Database Error in model int_customers_per_store (models/intermediate/int_customers_per_store.sql)
  syntax error at or near "models"
  LINE 4:     models:
              ^
  compiled Code at target/run/test_dbt_project/models/intermediate/int_customers_per_store.sql
[0m21:15:11.789787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc742290>]}
[0m21:15:11.790991 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.int_customers_per_store ........... [[31mERROR[0m in 0.11s]
[0m21:15:11.792269 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m21:15:11.793388 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payments
[0m21:15:11.795110 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_payments ............................... [RUN]
[0m21:15:11.797289 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.798560 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payments
[0m21:15:11.799624 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payments
[0m21:15:11.806334 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payments"
[0m21:15:11.825216 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:11.826571 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payments
[0m21:15:11.832996 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payments"
[0m21:15:11.855484 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.857191 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: BEGIN
[0m21:15:11.858858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:11.864070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:15:11.865605 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.867187 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m21:15:11.872981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:15:11.882017 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.883930 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
alter table "postgres"."public"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:15:11.885674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:11.890522 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.891862 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:15:11.893512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:11.918211 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: COMMIT
[0m21:15:11.920708 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.922328 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: COMMIT
[0m21:15:11.929199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:11.940376 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:15:11.942485 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m21:15:11.952159 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m21:15:11.955411 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:11.956898 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: Close
[0m21:15:11.958813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc740490>]}
[0m21:15:11.960523 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_payments .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:15:11.962432 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payments
[0m21:15:11.964070 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m21:15:11.965714 [info ] [Thread-1 (]: 3 of 10 START seed file public.customer_base ................................... [RUN]
[0m21:15:11.967727 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m21:15:11.969355 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m21:15:11.970777 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:11.972187 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m21:15:12.069976 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:15:12.071473 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m21:15:12.072620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:12.076559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:12.078679 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:15:12.080330 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m21:15:12.097628 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m21:15:13.413761 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:15:13.415579 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:15:13.431095 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.01 seconds
[0m21:15:13.439373 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m21:15:13.460152 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:15:13.462141 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:15:13.463745 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:15:13.478726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m21:15:13.480659 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.481826 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m21:15:13.483603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc742290>]}
[0m21:15:13.484748 [info ] [Thread-1 (]: 3 of 10 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.52s]
[0m21:15:13.486083 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m21:15:13.487363 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:15:13.488543 [info ] [Thread-1 (]: 4 of 10 SKIP test not_null_int_customers_per_store_store_id .................... [[33mSKIP[0m]
[0m21:15:13.489999 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:15:13.490956 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:15:13.492023 [info ] [Thread-1 (]: 5 of 10 SKIP test not_null_int_customers_per_store_total_customers ............. [[33mSKIP[0m]
[0m21:15:13.493259 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:15:13.494254 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:15:13.495206 [info ] [Thread-1 (]: 6 of 10 SKIP test unique_int_customers_per_store_store_id ...................... [[33mSKIP[0m]
[0m21:15:13.496681 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:15:13.497839 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:15:13.498864 [info ] [Thread-1 (]: 7 of 10 START test not_null_customer_base_customer_id .......................... [RUN]
[0m21:15:13.500363 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:15:13.501521 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:15:13.502993 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:15:13.521410 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:15:13.541820 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.543295 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:15:13.560451 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:15:13.579730 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:15:13.581149 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m21:15:13.582492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:13.586926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:13.588484 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:15:13.589711 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m21:15:13.592304 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:13.595490 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.634297 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m21:15:13.660291 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m21:15:13.662887 [info ] [Thread-1 (]: 7 of 10 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.16s]
[0m21:15:13.665666 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:15:13.667741 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:15:13.669409 [info ] [Thread-1 (]: 8 of 10 START test not_null_customer_base_store_id ............................. [RUN]
[0m21:15:13.672315 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:15:13.674424 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:15:13.676182 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:15:13.706491 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:15:13.727481 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.729377 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:15:13.735187 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:15:13.754773 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:15:13.756332 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m21:15:13.757804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:13.762822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:13.766882 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:15:13.768620 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m21:15:13.771768 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:13.775258 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.776752 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m21:15:13.778570 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m21:15:13.780840 [info ] [Thread-1 (]: 8 of 10 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.11s]
[0m21:15:13.784793 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:15:13.787537 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m21:15:13.789677 [info ] [Thread-1 (]: 9 of 10 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m21:15:13.792527 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:15:13.794102 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m21:15:13.795578 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m21:15:13.801188 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m21:15:13.821909 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.824970 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m21:15:13.834347 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m21:15:13.854317 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:15:13.856038 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m21:15:13.857987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:13.862996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:13.864810 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:15:13.866347 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    payment_date,
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1, 2
  );
[0m21:15:13.868917 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "payment_date" does not exist
LINE 5:     payment_date,
            ^

[0m21:15:13.870709 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: ROLLBACK
[0m21:15:13.872707 [debug] [Thread-1 (]: finished collecting timing info
[0m21:15:13.874241 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m21:15:13.876317 [debug] [Thread-1 (]: Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  column "payment_date" does not exist
  LINE 5:     payment_date,
              ^
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m21:15:13.878507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd186cd-1b45-4b0e-9a1b-4d603c3ff70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc633880>]}
[0m21:15:13.881275 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model public.int_revenue_by_date ............... [[31mERROR[0m in 0.09s]
[0m21:15:13.886563 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m21:15:13.899406 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m21:15:13.901148 [info ] [Thread-1 (]: 10 of 10 SKIP relation public.cumulative_revenue ............................... [[33mSKIP[0m]
[0m21:15:13.903366 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m21:15:13.910536 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:15:13.912724 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:13.915033 [debug] [MainThread]: On master: BEGIN
[0m21:15:13.916762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:13.925356 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:15:13.927845 [debug] [MainThread]: On master: COMMIT
[0m21:15:13.929663 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:13.931462 [debug] [MainThread]: On master: COMMIT
[0m21:15:13.933979 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:13.936657 [debug] [MainThread]: On master: Close
[0m21:15:13.939614 [info ] [MainThread]: 
[0m21:15:13.941529 [info ] [MainThread]: Finished running 3 view models, 1 seed, 5 tests, 1 table model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m21:15:13.943625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:13.945049 [debug] [MainThread]: Connection 'model.test_dbt_project.int_revenue_by_date' was properly closed.
[0m21:15:13.980465 [info ] [MainThread]: 
[0m21:15:13.982725 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:15:13.985761 [info ] [MainThread]: 
[0m21:15:13.988462 [error] [MainThread]: [33mDatabase Error in model int_customers_per_store (models/intermediate/int_customers_per_store.sql)[0m
[0m21:15:13.990171 [error] [MainThread]:   syntax error at or near "models"
[0m21:15:13.991861 [error] [MainThread]:   LINE 4:     models:
[0m21:15:13.993511 [error] [MainThread]:               ^
[0m21:15:13.994958 [error] [MainThread]:   compiled Code at target/run/test_dbt_project/models/intermediate/int_customers_per_store.sql
[0m21:15:13.996763 [info ] [MainThread]: 
[0m21:15:13.998451 [error] [MainThread]: [33mDatabase Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)[0m
[0m21:15:14.000219 [error] [MainThread]:   column "payment_date" does not exist
[0m21:15:14.002193 [error] [MainThread]:   LINE 5:     payment_date,
[0m21:15:14.003961 [error] [MainThread]:               ^
[0m21:15:14.006175 [error] [MainThread]:   compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m21:15:14.009218 [info ] [MainThread]: 
[0m21:15:14.011166 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=4 TOTAL=10
[0m21:15:14.013064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc633880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc6329e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc7410c0>]}
[0m21:15:14.014986 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:16:13.364490 | 9b3a43cb-87c2-4416-876e-99ec2aca2509 ==============================
[0m21:16:13.364510 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:16:13.367113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m21:16:13.369066 [debug] [MainThread]: Tracking: tracking
[0m21:16:13.385217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449c01600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449c016f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449c01690>]}
[0m21:16:13.388392 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mwaa_33x'
[0m21:16:13.389626 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:16:13.965948 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:16:13.968502 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:16:14.248015 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:16:14.300585 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:16:24.152424 [info ] [MainThread]:   Installed from version 1.0.0
[0m21:16:24.154066 [info ] [MainThread]:   Updated version available: 1.1.0
[0m21:16:24.155672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b3a43cb-87c2-4416-876e-99ec2aca2509', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449c019f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449c01810>]}
[0m21:16:24.157247 [info ] [MainThread]: 
[0m21:16:24.158817 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:16:24.161690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449d65390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449da5d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449c01150>]}
[0m21:16:24.163957 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:16:27.566203 | 3ec2ef94-0528-4e3e-951f-a89a7b3203b8 ==============================
[0m21:16:27.566220 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:16:27.567952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:16:27.569583 [debug] [MainThread]: Tracking: tracking
[0m21:16:27.572931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe28ee6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe28ee6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe28ee62f0>]}
[0m21:16:30.408163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:16:30.410465 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_revenue_by_date.sql
[0m21:16:30.412528 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/marts/cumulative_revenue.sql
[0m21:16:30.427978 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m21:16:30.453391 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m21:16:30.499091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe275d8190>]}
[0m21:16:30.525734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2758b520>]}
[0m21:16:30.527296 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:16:30.528841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe28eca3b0>]}
[0m21:16:30.531974 [info ] [MainThread]: 
[0m21:16:30.534332 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:16:30.536729 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:16:30.552175 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:16:30.554797 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:16:30.556204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:30.561847 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m21:16:30.564915 [debug] [ThreadPool]: On list_postgres: Close
[0m21:16:30.568044 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:16:30.576687 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:16:30.577969 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:16:30.579351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:30.583753 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:16:30.585335 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:16:30.586675 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:16:30.590859 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.0 seconds
[0m21:16:30.594079 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:16:30.596023 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:16:30.603598 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:30.605160 [debug] [MainThread]: On master: BEGIN
[0m21:16:30.606677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:30.610907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:30.612536 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:30.614158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:30.635728 [debug] [MainThread]: SQL status: SELECT 45 in 0.02 seconds
[0m21:16:30.640074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2758ac80>]}
[0m21:16:30.641748 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:30.643529 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:30.644515 [debug] [MainThread]: On master: BEGIN
[0m21:16:30.646537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:30.648193 [debug] [MainThread]: On master: COMMIT
[0m21:16:30.649961 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:30.651375 [debug] [MainThread]: On master: COMMIT
[0m21:16:30.652833 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:30.654201 [debug] [MainThread]: On master: Close
[0m21:16:30.656194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:30.657249 [info ] [MainThread]: 
[0m21:16:30.661985 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m21:16:30.663681 [info ] [Thread-1 (]: 1 of 10 START sql view model public.int_customers_per_store .................... [RUN]
[0m21:16:30.665506 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:16:30.666784 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m21:16:30.668041 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m21:16:30.672382 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m21:16:30.695188 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:30.697064 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m21:16:30.739083 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m21:16:30.758219 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:16:30.760131 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m21:16:30.761686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:30.765905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:30.767298 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:16:30.768480 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    models:
  - name: int_revenue_by_date
  - name: int_customers_per_store
    columns:
      - name: store_id
        tests:
          - unique
          - not_null
      - name: total_customers
        tests:
          - not_null
  );
[0m21:16:30.770049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "models"
LINE 4:     models:
            ^

[0m21:16:30.771546 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: ROLLBACK
[0m21:16:30.773231 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:30.774374 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m21:16:30.776331 [debug] [Thread-1 (]: Database Error in model int_customers_per_store (models/intermediate/int_customers_per_store.sql)
  syntax error at or near "models"
  LINE 4:     models:
              ^
  compiled Code at target/run/test_dbt_project/models/intermediate/int_customers_per_store.sql
[0m21:16:30.777536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe26688f70>]}
[0m21:16:30.779150 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.int_customers_per_store ........... [[31mERROR[0m in 0.11s]
[0m21:16:30.781100 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m21:16:30.782512 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payments
[0m21:16:30.784009 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_payments ............................... [RUN]
[0m21:16:30.786257 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.788703 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payments
[0m21:16:30.789939 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payments
[0m21:16:30.793919 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payments"
[0m21:16:30.813617 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:30.815321 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payments
[0m21:16:30.823803 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payments"
[0m21:16:30.846998 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.848306 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: BEGIN
[0m21:16:30.849775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:30.854433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:30.856149 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.857652 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m21:16:30.864905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m21:16:30.879150 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.881308 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
alter table "postgres"."public"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:16:30.883735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:30.891282 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.892979 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:16:30.894926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:30.925194 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: COMMIT
[0m21:16:30.926757 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.928112 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: COMMIT
[0m21:16:30.931655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:16:30.938328 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payments"
[0m21:16:30.940496 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m21:16:30.944393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:16:30.946767 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:30.948188 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payments: Close
[0m21:16:30.950603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe26688640>]}
[0m21:16:30.952694 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_payments .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:16:30.954759 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payments
[0m21:16:30.956513 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m21:16:30.958206 [info ] [Thread-1 (]: 3 of 10 START seed file public.customer_base ................................... [RUN]
[0m21:16:30.961710 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m21:16:30.965030 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m21:16:30.967571 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:30.969307 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m21:16:31.118385 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:16:31.120295 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m21:16:31.121746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:31.126226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:31.127912 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:16:31.129515 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m21:16:31.135185 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:16:32.669280 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:16:32.671587 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:16:32.690357 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.02 seconds
[0m21:16:32.699894 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m21:16:32.722544 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:16:32.723980 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:16:32.725451 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:16:32.739791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m21:16:32.742681 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:32.744159 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m21:16:32.746301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2aa38760>]}
[0m21:16:32.748196 [info ] [Thread-1 (]: 3 of 10 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.79s]
[0m21:16:32.750346 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m21:16:32.751781 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:16:32.753133 [info ] [Thread-1 (]: 4 of 10 SKIP test not_null_int_customers_per_store_store_id .................... [[33mSKIP[0m]
[0m21:16:32.754863 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:16:32.756268 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:16:32.758062 [info ] [Thread-1 (]: 5 of 10 SKIP test not_null_int_customers_per_store_total_customers ............. [[33mSKIP[0m]
[0m21:16:32.760036 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:16:32.761555 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:16:32.763092 [info ] [Thread-1 (]: 6 of 10 SKIP test unique_int_customers_per_store_store_id ...................... [[33mSKIP[0m]
[0m21:16:32.764891 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:16:32.766978 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:16:32.769383 [info ] [Thread-1 (]: 7 of 10 START test not_null_customer_base_customer_id .......................... [RUN]
[0m21:16:32.773090 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:16:32.774823 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:16:32.776175 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:16:32.790920 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:16:32.816445 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:32.818776 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:16:32.836371 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:16:32.862514 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:16:32.864077 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m21:16:32.865356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:32.869190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:32.870473 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:16:32.871620 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m21:16:32.884979 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:16:32.889235 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:32.892596 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m21:16:32.894298 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m21:16:32.896293 [info ] [Thread-1 (]: 7 of 10 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.12s]
[0m21:16:32.898165 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:16:32.899678 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:16:32.900925 [info ] [Thread-1 (]: 8 of 10 START test not_null_customer_base_store_id ............................. [RUN]
[0m21:16:32.904009 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:16:32.905815 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:16:32.907157 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:16:32.913731 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:16:32.935034 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:32.936681 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:16:32.942298 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:16:32.961779 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:16:32.963533 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m21:16:32.965336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:32.970915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:16:32.972432 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:16:32.973698 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m21:16:32.976624 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:16:32.982161 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:32.984190 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m21:16:32.985762 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m21:16:32.987359 [info ] [Thread-1 (]: 8 of 10 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.08s]
[0m21:16:32.988815 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:16:32.990810 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m21:16:32.992227 [info ] [Thread-1 (]: 9 of 10 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m21:16:32.994311 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:16:32.995733 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m21:16:32.997384 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m21:16:33.003149 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m21:16:33.028148 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:33.030702 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m21:16:33.040173 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m21:16:33.071605 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:16:33.073095 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m21:16:33.074288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:33.079015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:33.080936 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:16:33.083185 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1, 2
  );
[0m21:16:33.085976 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 6:     COUNT(*) AS total_customers
            ^

[0m21:16:33.087526 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: ROLLBACK
[0m21:16:33.089069 [debug] [Thread-1 (]: finished collecting timing info
[0m21:16:33.090350 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m21:16:33.092053 [debug] [Thread-1 (]: Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 6:     COUNT(*) AS total_customers
              ^
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m21:16:33.093841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ec2ef94-0528-4e3e-951f-a89a7b3203b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe266c2260>]}
[0m21:16:33.095901 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model public.int_revenue_by_date ............... [[31mERROR[0m in 0.10s]
[0m21:16:33.098030 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m21:16:33.100434 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m21:16:33.101891 [info ] [Thread-1 (]: 10 of 10 SKIP relation public.cumulative_revenue ............................... [[33mSKIP[0m]
[0m21:16:33.103578 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m21:16:33.109601 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:16:33.111362 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:33.113404 [debug] [MainThread]: On master: BEGIN
[0m21:16:33.115249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:33.119934 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:33.121577 [debug] [MainThread]: On master: COMMIT
[0m21:16:33.123146 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:33.126857 [debug] [MainThread]: On master: COMMIT
[0m21:16:33.128524 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:33.130537 [debug] [MainThread]: On master: Close
[0m21:16:33.132522 [info ] [MainThread]: 
[0m21:16:33.133945 [info ] [MainThread]: Finished running 3 view models, 1 seed, 5 tests, 1 table model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m21:16:33.135267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:33.136282 [debug] [MainThread]: Connection 'model.test_dbt_project.int_revenue_by_date' was properly closed.
[0m21:16:33.168367 [info ] [MainThread]: 
[0m21:16:33.170308 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:16:33.172183 [info ] [MainThread]: 
[0m21:16:33.174287 [error] [MainThread]: [33mDatabase Error in model int_customers_per_store (models/intermediate/int_customers_per_store.sql)[0m
[0m21:16:33.178620 [error] [MainThread]:   syntax error at or near "models"
[0m21:16:33.181389 [error] [MainThread]:   LINE 4:     models:
[0m21:16:33.183084 [error] [MainThread]:               ^
[0m21:16:33.184623 [error] [MainThread]:   compiled Code at target/run/test_dbt_project/models/intermediate/int_customers_per_store.sql
[0m21:16:33.186041 [info ] [MainThread]: 
[0m21:16:33.187599 [error] [MainThread]: [33mDatabase Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)[0m
[0m21:16:33.189387 [error] [MainThread]:   aggregate functions are not allowed in GROUP BY
[0m21:16:33.192384 [error] [MainThread]:   LINE 6:     COUNT(*) AS total_customers
[0m21:16:33.195244 [error] [MainThread]:               ^
[0m21:16:33.197716 [error] [MainThread]:   compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m21:16:33.199873 [info ] [MainThread]: 
[0m21:16:33.201632 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=4 TOTAL=10
[0m21:16:33.203488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe266ff250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe26689480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe266c00a0>]}
[0m21:16:33.205048 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:18:24.412319 | d74ba8fe-6d10-48a6-86b5-293264f3468b ==============================
[0m21:18:24.412337 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:18:24.414170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m21:18:24.415399 [debug] [MainThread]: Tracking: tracking
[0m21:18:24.419228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662104d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662104d6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662104d690>]}
[0m21:18:24.424517 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_rejlok_'
[0m21:18:24.425803 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:18:24.876036 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:18:24.878714 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:18:25.179626 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:18:25.225153 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:18:34.924884 [info ] [MainThread]:   Installed from version 1.0.0
[0m21:18:34.926499 [info ] [MainThread]:   Updated version available: 1.1.0
[0m21:18:34.928069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd74ba8fe-6d10-48a6-86b5-293264f3468b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662104d9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662104d810>]}
[0m21:18:34.929555 [info ] [MainThread]: 
[0m21:18:34.930942 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:18:34.934667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66211b1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66211f1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662104d000>]}
[0m21:18:34.936475 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:18:37.917986 | 6151faee-b9f7-46ae-ace5-a2106eb0d03f ==============================
[0m21:18:37.918009 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:18:37.919608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:18:37.920899 [debug] [MainThread]: Tracking: tracking
[0m21:18:37.923947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49538d2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49538d2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49538d22f0>]}
[0m21:18:40.493169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:18:40.495562 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/marts/cumulative_revenue.sql
[0m21:18:40.497563 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_customers_per_store.sql
[0m21:18:40.498943 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_revenue_by_date.sql
[0m21:18:40.516687 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m21:18:40.536114 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m21:18:40.540542 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m21:18:40.568123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49537321a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49536ea830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49536e96c0>]}
[0m21:18:40.570436 [debug] [MainThread]: Flushing usage events
[0m21:18:41.358381 [error] [MainThread]: Encountered an error:
Compilation Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  Model 'model.test_dbt_project.int_revenue_by_date' (models/intermediate/int_revenue_by_date.sql) depends on a node named 'stg_payment' which was not found


============================== 2023-05-04 21:19:33.017899 | 403578e9-bb1f-4ccb-92ac-e4d5f5351cb7 ==============================
[0m21:19:33.017915 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:19:33.019492 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m21:19:33.020865 [debug] [MainThread]: Tracking: tracking
[0m21:19:33.023985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d255630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d255720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d2556c0>]}
[0m21:19:33.030094 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rc9wk54p'
[0m21:19:33.032333 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:19:33.501844 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:19:33.506465 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:19:33.777692 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:19:33.829258 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:19:44.805657 [info ] [MainThread]:   Installed from version 1.0.0
[0m21:19:44.808052 [info ] [MainThread]:   Updated version available: 1.1.0
[0m21:19:44.809572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '403578e9-bb1f-4ccb-92ac-e4d5f5351cb7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d255a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d255840>]}
[0m21:19:44.811282 [info ] [MainThread]: 
[0m21:19:44.812760 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:19:44.814528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d3b93c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d3f9120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417d255180>]}
[0m21:19:44.816290 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 21:19:48.904816 | eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704 ==============================
[0m21:19:48.904839 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:19:48.907202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:19:48.908838 [debug] [MainThread]: Tracking: tracking
[0m21:19:48.912133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5eb2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5eb1fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5eb2020>]}
[0m21:19:52.229212 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m21:19:52.231456 [debug] [MainThread]: Partial parsing: added file: test_dbt_project://models/staging/stg_payment.sql
[0m21:19:52.233331 [debug] [MainThread]: Partial parsing: deleted file: test_dbt_project://models/staging/stg_payments.sql
[0m21:19:52.235518 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/marts/cumulative_revenue.sql
[0m21:19:52.237635 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_revenue_by_date.sql
[0m21:19:52.239469 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/intermediate/int_customers_per_store.sql
[0m21:19:52.266303 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m21:19:52.285930 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m21:19:52.291585 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m21:19:52.297906 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m21:19:52.401904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4b5c220>]}
[0m21:19:52.444370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5e323e0>]}
[0m21:19:52.446730 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:19:52.449235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5e97c40>]}
[0m21:19:52.453519 [info ] [MainThread]: 
[0m21:19:52.457727 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:19:52.473829 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:19:52.495298 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:19:52.497437 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:19:52.500283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:52.509664 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m21:19:52.513544 [debug] [ThreadPool]: On list_postgres: Close
[0m21:19:52.518383 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:19:52.529146 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:19:52.530882 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:19:52.532424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:52.537226 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:19:52.539209 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:19:52.541054 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:19:52.548166 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.01 seconds
[0m21:19:52.554161 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:19:52.556554 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:19:52.566848 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:52.568896 [debug] [MainThread]: On master: BEGIN
[0m21:19:52.570723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:52.578624 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m21:19:52.580964 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:52.583243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:52.596876 [debug] [MainThread]: SQL status: SELECT 45 in 0.01 seconds
[0m21:19:52.604507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5eb3d00>]}
[0m21:19:52.606885 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:52.609026 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:52.610858 [debug] [MainThread]: On master: BEGIN
[0m21:19:52.615270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:52.617223 [debug] [MainThread]: On master: COMMIT
[0m21:19:52.618770 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:52.620674 [debug] [MainThread]: On master: COMMIT
[0m21:19:52.624207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:19:52.626697 [debug] [MainThread]: On master: Close
[0m21:19:52.629040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:52.631415 [info ] [MainThread]: 
[0m21:19:52.640457 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m21:19:52.642757 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_payment ................................ [RUN]
[0m21:19:52.645362 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m21:19:52.647546 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m21:19:52.649169 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m21:19:52.655946 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m21:19:52.685102 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:52.687225 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m21:19:52.773429 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m21:19:52.790016 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m21:19:52.791553 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m21:19:52.793048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:52.798752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m21:19:52.800317 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m21:19:52.801572 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m21:19:52.807706 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:19:52.821790 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m21:19:52.823243 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m21:19:52.825170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:52.857536 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m21:19:52.858946 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m21:19:52.860012 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m21:19:52.863777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:52.873953 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m21:19:52.875244 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m21:19:52.877002 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:19:52.879458 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:52.880943 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m21:19:52.882854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4a333a0>]}
[0m21:19:52.884337 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.24s]
[0m21:19:52.885860 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m21:19:52.887220 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m21:19:52.888810 [info ] [Thread-1 (]: 2 of 10 START seed file public.customer_base ................................... [RUN]
[0m21:19:52.891037 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m21:19:52.894435 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m21:19:52.896274 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:52.897681 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m21:19:53.049709 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:19:53.052501 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m21:19:53.054230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:53.058972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:53.061660 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:19:53.063424 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m21:19:53.081822 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m21:19:54.398433 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:19:54.400943 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:19:54.415674 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.01 seconds
[0m21:19:54.423950 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m21:19:54.449611 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:19:54.451520 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m21:19:54.453426 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m21:19:54.467120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m21:19:54.468726 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.469932 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m21:19:54.471610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed922a350>]}
[0m21:19:54.473057 [info ] [Thread-1 (]: 2 of 10 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.58s]
[0m21:19:54.474388 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m21:19:54.475585 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m21:19:54.476953 [info ] [Thread-1 (]: 3 of 10 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m21:19:54.478777 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.481918 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m21:19:54.483715 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m21:19:54.487735 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.506119 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.507887 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m21:19:54.517501 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.538657 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.540045 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m21:19:54.541098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:54.545335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:54.548901 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.550924 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m21:19:54.568777 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m21:19:54.573656 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.575418 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date" rename to "int_revenue_by_date__dbt_backup"
[0m21:19:54.577909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:54.584003 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.585396 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m21:19:54.587200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:54.591899 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m21:19:54.593032 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.594072 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m21:19:54.598552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:54.603508 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m21:19:54.605142 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m21:19:54.608436 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:19:54.611491 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.615254 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m21:19:54.617917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4c1d3f0>]}
[0m21:19:54.619672 [info ] [Thread-1 (]: 3 of 10 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.14s]
[0m21:19:54.621097 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m21:19:54.622312 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:19:54.623405 [info ] [Thread-1 (]: 4 of 10 START test not_null_customer_base_customer_id .......................... [RUN]
[0m21:19:54.624836 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:19:54.625909 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:19:54.626965 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:19:54.643152 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:19:54.665613 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.668051 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:19:54.685573 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:19:54.703900 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:19:54.705105 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m21:19:54.706193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:54.709937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:54.711451 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m21:19:54.712645 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m21:19:54.714600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:19:54.717298 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.718511 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m21:19:54.719687 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m21:19:54.721338 [info ] [Thread-1 (]: 4 of 10 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.10s]
[0m21:19:54.722663 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m21:19:54.723847 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:19:54.725019 [info ] [Thread-1 (]: 5 of 10 START test not_null_customer_base_store_id ............................. [RUN]
[0m21:19:54.726927 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:19:54.728093 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:19:54.729166 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:19:54.735874 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:19:54.762157 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.763800 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:19:54.768632 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:19:54.789811 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:19:54.791557 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m21:19:54.793087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:54.796824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:54.798863 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m21:19:54.800623 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m21:19:54.804605 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:19:54.807140 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.808270 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m21:19:54.809515 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m21:19:54.810990 [info ] [Thread-1 (]: 5 of 10 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.08s]
[0m21:19:54.812338 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m21:19:54.813702 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m21:19:54.815619 [info ] [Thread-1 (]: 6 of 10 START sql table model public.cumulative_revenue ........................ [RUN]
[0m21:19:54.817398 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:19:54.818543 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m21:19:54.819539 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m21:19:54.824023 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m21:19:54.846882 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:54.849020 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m21:19:54.874571 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m21:19:54.897889 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:19:54.899323 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m21:19:54.900889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:54.905311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:54.906424 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:19:54.907412 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m21:19:55.005096 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.1 seconds
[0m21:19:55.010948 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:19:55.012501 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m21:19:55.014449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:55.020698 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m21:19:55.022187 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:19:55.023404 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m21:19:55.026173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:55.029153 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m21:19:55.030131 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m21:19:55.031263 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:19:55.033087 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.033865 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m21:19:55.035126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4a877c0>]}
[0m21:19:55.036190 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.cumulative_revenue ................... [[32mSELECT 40[0m in 0.22s]
[0m21:19:55.037234 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m21:19:55.038178 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m21:19:55.039331 [info ] [Thread-1 (]: 7 of 10 START sql view model public.int_customers_per_store .................... [RUN]
[0m21:19:55.040816 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.041998 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m21:19:55.043112 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m21:19:55.049085 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.069894 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.071477 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m21:19:55.080739 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.108275 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.110378 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m21:19:55.112667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:55.117278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:55.118932 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.120460 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m21:19:55.125719 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:19:55.131997 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.133827 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m21:19:55.135986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:55.139421 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m21:19:55.141741 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.143581 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m21:19:55.146728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:55.150766 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m21:19:55.152387 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m21:19:55.156252 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:19:55.158558 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.159824 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m21:19:55.161576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebb0ddc-d27d-4be4-9bd9-5f1df0e4f704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5eb0fa0>]}
[0m21:19:55.163832 [info ] [Thread-1 (]: 7 of 10 OK created sql view model public.int_customers_per_store ............... [[32mCREATE VIEW[0m in 0.12s]
[0m21:19:55.165841 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m21:19:55.169423 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:19:55.171370 [info ] [Thread-1 (]: 8 of 10 START test not_null_int_customers_per_store_store_id ................... [RUN]
[0m21:19:55.173445 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m21:19:55.175605 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:19:55.177659 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:19:55.187694 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m21:19:55.225040 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.226320 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:19:55.230543 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m21:19:55.268683 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m21:19:55.269902 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m21:19:55.271083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:55.274927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:55.276242 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m21:19:55.277468 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m21:19:55.280139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:19:55.286178 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.287896 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m21:19:55.289866 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m21:19:55.291990 [info ] [Thread-1 (]: 8 of 10 PASS not_null_int_customers_per_store_store_id ......................... [[32mPASS[0m in 0.12s]
[0m21:19:55.294366 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m21:19:55.296575 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:19:55.298788 [info ] [Thread-1 (]: 9 of 10 START test not_null_int_customers_per_store_total_customers ............ [RUN]
[0m21:19:55.300922 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m21:19:55.302422 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:19:55.304731 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:19:55.314024 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m21:19:55.341913 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.343860 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:19:55.350415 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m21:19:55.376401 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m21:19:55.378232 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m21:19:55.379991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:55.384596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:55.386157 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m21:19:55.387746 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m21:19:55.390835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:19:55.394037 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.395216 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m21:19:55.397074 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m21:19:55.400563 [info ] [Thread-1 (]: 9 of 10 PASS not_null_int_customers_per_store_total_customers .................. [[32mPASS[0m in 0.10s]
[0m21:19:55.402544 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m21:19:55.403978 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:19:55.405137 [info ] [Thread-1 (]: 10 of 10 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m21:19:55.406711 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m21:19:55.407823 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:19:55.408829 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:19:55.417080 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m21:19:55.438466 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.440851 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:19:55.444697 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m21:19:55.464952 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m21:19:55.468056 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m21:19:55.470326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:55.475046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:55.476778 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m21:19:55.478233 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:19:55.492333 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m21:19:55.495243 [debug] [Thread-1 (]: finished collecting timing info
[0m21:19:55.496551 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m21:19:55.497996 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m21:19:55.499778 [info ] [Thread-1 (]: 10 of 10 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.09s]
[0m21:19:55.501730 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m21:19:55.506755 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:19:55.508082 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:55.509303 [debug] [MainThread]: On master: BEGIN
[0m21:19:55.510589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:55.514649 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:55.516104 [debug] [MainThread]: On master: COMMIT
[0m21:19:55.517563 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:55.519589 [debug] [MainThread]: On master: COMMIT
[0m21:19:55.522455 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:19:55.523838 [debug] [MainThread]: On master: Close
[0m21:19:55.525527 [info ] [MainThread]: 
[0m21:19:55.527549 [info ] [MainThread]: Finished running 3 view models, 1 seed, 5 tests, 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m21:19:55.529814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:55.531221 [debug] [MainThread]: Connection 'test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d' was properly closed.
[0m21:19:55.561926 [info ] [MainThread]: 
[0m21:19:55.563913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:55.565634 [info ] [MainThread]: 
[0m21:19:55.567285 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m21:19:55.570475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5e32650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4bad6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4bad750>]}
[0m21:19:55.572193 [debug] [MainThread]: Flushing usage events
